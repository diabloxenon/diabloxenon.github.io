<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>diabloxenon/journal/just-random-things/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    
    
    
    
    
    <link rel="stylesheet" href="/css/bundle.min.194e69a1c3f1adac8218a0e7f2f02f2bd0b4b6a07d71d15480ecf9c6d8db07d190e81a15faaf5aaa87dc5ac70fecf9023fad8b5bd8f0b71dd1eaad760ae9785b.css" integrity="sha512-GU5pocPxrayCGKDn8vAvK9C0tqB9cdFUgOz5xtjbB9GQ6BoV+q9aqofcWscP7PkCP62LW9jwtx3R6q12Cul4Ww=="> 
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Just random things" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://nmnx.org/journal/just-random-things/" /><meta property="article:published_time" content="2020-11-15T00:00:00+00:00" />



<meta name="twitter:title" content="Just random things"/>
<meta name="twitter:description" content="Random things aren&rsquo;t random at all. Sometimes, it might be difficult for your beloved PC to generate a proper entropy for things that needs to be random. We will explore the solution behind this peculiar problem."/>

</head>

<body class="xeno">
    <div class="container">
        <div class="xeno-nav">
            <header class="xeno-logo">
                <div class="logo xeno-prompt">
                     
                    <a href="http://nmnx.org/" class="no-style site-name">diabloxenon</a>:~# /<a href='http://nmnx.org/journal'>journal</a>/<a href='http://nmnx.org/journal/just-random-things'>just-random-things</a>/
                </div>
            </header>
            <nav class="xeno-menu">
                <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                    <div class="nav">
                        
                        <li><a href="http://nmnx.org/awards" typeof="ListItem">/awards</a></li>
                        
                        <li><a href="http://nmnx.org/journal" typeof="ListItem">/journal</a></li>
                        
                        <li><a href="http://nmnx.org/dev" typeof="ListItem">/dev</a></li>
                        
                        <li><a href="http://nmnx.org/tags" typeof="ListItem">/tags</a></li>
                        
                    </div>
                    <div class="social">
                        
                        <li><a href="https://t.me/diabloxenon" typeof="ListItem" target="_blank" rel="nofollow noreferrer"><span class="icon"></span></a></li>
                        
                        <li><a href="https://github.com/diabloxenon" typeof="ListItem" target="_blank" rel="nofollow noreferrer"><span class="icon"></span></a></li>
                        
                        <li><a href="https://twitter.com/diabloxenon" typeof="ListItem" target="_blank" rel="nofollow noreferrer"><span class="icon"></span></a></li>
                        
                    </div>
                </ul>
            </nav>
        </div>
    </div>

    <div class="container">
        
<h1>Just random things</h1>
<div class="title">
    <div class="date">
        Nov. 15, 2020
    </div>
    <ul class="tags">
        
        <li>
            <a href="http://nmnx.org/tags/debate/">
                <div class="tagid">
                    Debate
                </div>
            </a>
        </li>
        
        <li>
            <a href="http://nmnx.org/tags/privacy/">
                <div class="tagid">
                    Privacy
                </div>
            </a>
        </li>
        
        <li>
            <a href="http://nmnx.org/tags/rng/">
                <div class="tagid">
                    RNG
                </div>
            </a>
        </li>
        
    </ul>
</div>
<br /><p>Random things aren&rsquo;t random at all. Sometimes, it might be difficult for your beloved PC to generate a proper entropy for things that needs to be random. We will explore the solution behind this peculiar problem.</p>

<p>Like all things in this universe are random, your PC might annoy you for things like it can&rsquo;t find any random entropy and all. This is an error and it is random, like all things are (should have said something random)!</p>

<p>In this journal entry, we will discuss what should you do when this kind of problem occurs.</p>

<h4 id="1-check-if-your-system-is-generating-proper-entropy">1. Check if your system is generating proper entropy.</h4>

<p>To verify, we always see the entropy is in between of certain threshold values. For a healthy system, our entropy should around 4,096 which is the poolsize for your kernel. You can verify this by:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">cat /proc/sys/kernel/random/poolsize</code></pre></div>
<p>This will output the upper limit of your poolsize, before it is again dumped out and becomes zero. System can be said faulty, if its entropy falls below 250 even after long run. Therefore, a good region is <strong>1024 &lt; entropy &lt; 4096</strong>. For the values mentioned above, you can refer to the <a href="/journal/experiments-rng">this entry</a>. Check your system&rsquo;s entropy with the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">cat /proc/sys/kernel/random/entropy_avail</code></pre></div>
<p>If your entropy is not in the region, then there below mentioned is the solution you should try with.</p>

<h4 id="2-pseudorandom-number-generator-prngs">2. Pseudorandom number generator (PRNGs)</h4>

<p>Previously, we have already discussed this before in this <a href="/journal/wipe-disks#few-notes">journal entry</a> where we talked about how <code>/dev/random</code> is slower than <code>/dev/urandom</code>. This is because of less entropy collection done by <code>/dev/random</code> since it only collects from less frequent devices (Keyboard interrupts, Mouse motion, disk accesses) etc. Your system may partake in less generation of entropy due to this reason (in cases for servers and CLI based environments). However, there is considerablity for the solution of external (more faster) random number generation. Now now, you won&rsquo;t be needing any specialized hardware setup (although <a href="https://en.wikipedia.org/wiki/TRNG" rel="nofollow noreferrer" target="_blank">these</a> things exists) for you to generate some random keys. Your processor manufacturer, already provides a TRNG hardware inside it.</p>

<p>Programs like <a href="https://github.com/nhorman/rng-tools" rel="nofollow noreferrer" target="_blank">rng-tools</a>, <a href="https://en.wikipedia.org/wiki/Yarrow_algorithm" rel="nofollow noreferrer" target="_blank">Yarrow</a> (co-devised by <a href="https://en.wikipedia.org/wiki/Bruce_Schneier" rel="nofollow noreferrer" target="_blank">Bruce Schneier</a>), <a href="https://en.wikipedia.org/wiki/Fortuna_(PRNG)" rel="nofollow noreferrer" target="_blank">Fortuna</a> (successor of Yarrow, implemented in FreeBSD)</p>

<p>Another good thing I would like to mention is, <em>rng-tools</em>, <em>Haveged</em>, <em>Frandom</em> are not suitable for long-term cryptographic keys as mentioned here in this <a href="https://wiki.archlinux.org/index.php/Random_number_generation#Alternatives" rel="nofollow noreferrer" target="_blank">documentation</a>. The community have clearly explained this in their documentation, I am only making it brief.</p>

<p>TRNGs are known in the industry to not generate numbers that random. See Schneier&rsquo;s article on</p>

<h4 id="3-dev-random-vs-dev-urandom-verdict">3. /dev/random vs /dev/urandom verdict</h4>

<p>This <a href="https://www.ietf.org/rfc/rfc4086.txt" rel="nofollow noreferrer" target="_blank">RFC4086</a> have also described it well on how the Linux kernel generates randomness for <code>/dev/random</code> by input data from various devices, along with their techniques.</p>

<p>A proper seed generation is always a must to ensure that random bits generated are always different in long term. This is ensured by the kernel by using cryptographically secure PRNG.</p>

<p>However, to quote from the RFC mentioned, I would like to mention this decade old argument on which one is safe. As mentioned on page 29 of this RFC:</p>

<blockquote>
<p>/dev/urandom works like /dev/random; however, it provides data even
   when the entropy estimate for the random pool drops to zero.  This
   may be adequate for session keys or for other key generation tasks
   for which blocking to await more random bits is not acceptable.  The
   risk of continuing to take data even when the pool&rsquo;s entropy estimate
   is small in that past output may be computable from current output,
   provided that an attacker can reverse SHA-1.  Given that SHA-1 is
   designed to be non-invertible, this is a reasonable risk.</p>
</blockquote>

<p>In simpler terms, <code>/dev/urandom</code> can be used to generate <strong>short term</strong> private keys (i.e. for sessions, token, otp, etc.) but <code>/dev/random</code> should be used in cases of <strong>keys that cannot be replaced often</strong>, like your (LUKS keyfile, SSH keys, GPG keys, etc.). But then again this is a sincere advice from my side, however should the opinions matters yet again, I would advice to refer to this point then.</p>

<p>If you feel like something else should also have been mentioned in this entry, feel free to email me about.</p>

<p>That&rsquo;s all for today! Thank you for reading this journal. Let&rsquo;s see you again next time.</p>   <div class="footer">
    <ul class="links">
        <div class="copy">
            echo (C) 2021&nbsp;<a href="https://naman.rocks" target="_blank" rel="nofollow noreferrer">Naman Bishnoi</a>&nbsp;| cat &nbsp;
        </div>
        <li><a href="mailto:me@nmnx.org" target="_blank" rel="nofollow noreferrer">me@nmnx.org</a></li>
        <li><a href="/about">/about</a></li>
        <li><a href="/donate">/donate</a></li>
        <li><a href="/credits">/credits</a></li>
        <li><a href="/privacy">/privacy</a></li>
        <li><a href="/pgp">/pgp</a></li>
        <li><a href="#">/top</a></li>
        <li>
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="nofollow noreferrer"><img alt="Creative Commons Licence" style="border-width:0;width:88px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
        </li>
        
    </ul>
</div>


<script>
    console.log("Yeah yeah whatevs, just check the code!");
</script>
    </div>
</body>

</html>